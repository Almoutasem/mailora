<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mailora ‚Äì Email Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9fb;
      display: flex;
      flex-direction: row;
      height: 100vh;
    }
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .toolbar, .stylebar {
      display: flex;
      gap: 10px;
      padding: 10px 20px;
      background: #fff;
      border-bottom: 1px solid #ddd;
    }
    .toolbar button, .toolbar select,
    .stylebar input, .stylebar select {
      padding: 6px 12px;
      cursor: pointer;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
    }
    #editor, #preview {
      flex: 1;
      overflow-y: auto;
      background: #fff;
      padding: 30px;
      font-size: 16px;
    }
    #preview {
      display: none;
      white-space: pre-wrap;
    }
    .block {
      border: 1px dashed #ccc;
      background: #fefefe;
      margin-bottom: 12px;
      padding: 14px;
      position: relative;
      cursor: move;
    }
    .remove-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      font-size: 14px;
      cursor: pointer;
    }

    .drag-panel {
      width: 180px;
      background: #2b2d42;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px;
      gap: 10px;
      border-left: 1px solid #1a1a1a;
    }
    .drag-panel h4 {
      color: #ccc;
      font-weight: normal;
      margin-bottom: 12px;
    }
    .drag-item {
      width: 100%;
      background: #3a3d5c;
      padding: 10px 12px;
      border-radius: 6px;
      text-align: center;
      cursor: grab;
      user-select: none;
      transition: background 0.2s;
    }
    .drag-item:hover {
      background: #4e5170;
    }

    .export-btn, .toggle-btn {
      position: fixed;
      bottom: 100px;
      left: 20px;
      padding: 10px 15px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .toggle-btn {
      bottom: 50px;
      background: #444;
    }

    .device-toggle {
      position: fixed;
      top: 20px;
      right: 200px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .device-toggle button {
      padding: 6px 10px;
      background: #555;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .device-frame {
      max-width: 100%;
      margin: auto;
      transition: all 0.2s ease;
    }
    .mobile .device-frame {
      width: 375px;
    }
    .tablet .device-frame {
      width: 768px;
    }
    .desktop .device-frame {
      width: 100%;
    }
  </style>
</head>
<body class="desktop">

<div class="main-content">
  <div class="toolbar">
    <select id="heading">
      <option value="p">Paragraph</option>
      <option value="h1">Heading 1</option>
      <option value="h2">Heading 2</option>
      <option value="h3">Heading 3</option>
    </select>
    <select onchange="document.execCommand('fontSize', false, this.value)">
      <option value="2">Small</option>
      <option value="3" selected>Normal</option>
      <option value="5">Large</option>
      <option value="6">X-Large</option>
    </select>
    <button onclick="format('bold')"><i class="fas fa-bold"></i></button>
    <button onclick="format('italic')"><i class="fas fa-italic"></i></button>
    <button onclick="format('underline')"><i class="fas fa-underline"></i></button>
    <button onclick="format('strikeThrough')"><i class="fas fa-strikethrough"></i></button>
    <button onclick="format('justifyLeft')"><i class="fas fa-align-left"></i></button>
    <button onclick="format('justifyCenter')"><i class="fas fa-align-center"></i></button>
    <button onclick="format('justifyRight')"><i class="fas fa-align-right"></i></button>
    <button onclick="format('insertUnorderedList')"><i class="fas fa-list-ul"></i></button>
    <button onclick="format('insertOrderedList')"><i class="fas fa-list-ol"></i></button>
  </div>

  <div class="stylebar">
    Font:
    <select onchange="document.execCommand('fontName', false, this.value)">
      <option value="Segoe UI">Segoe UI</option>
      <option value="Arial">Arial</option>
      <option value="Georgia">Georgia</option>
      <option value="Courier New">Courier</option>
      <option value="Tahoma">Tahoma</option>
      <option value="Verdana">Verdana</option>
    </select>
    Background: <input type="color" onchange="document.getElementById('editor').style.backgroundColor = this.value" />
    Text Color: <input type="color" onchange="document.execCommand('foreColor', false, this.value)">
    Highlight: <input type="color" onchange="document.execCommand('hiliteColor', false, this.value)">
  </div>

  <div id="editor" class="canvas device-frame" contenteditable="true"
       ondragover="event.preventDefault()" ondrop="handleDrop(event)"></div>

  <pre id="preview" class="device-frame"></pre>
</div>

<div class="drag-panel">
  <h4>Blocks</h4>
  <div class="drag-item" draggable="true" ondragstart="drag(event, 'text')">Text</div>
  <div class="drag-item" draggable="true" ondragstart="drag(event, 'image')">Image</div>
  <div class="drag-item" draggable="true" ondragstart="drag(event, 'section')">Section</div>
  <div class="drag-item" draggable="true" ondragstart="drag(event, 'button')">Button</div>
  <div class="drag-item" draggable="true" ondragstart="drag(event, 'divider')">Divider</div>
</div>

<button class="export-btn" onclick="exportHTML()">‚¨á Export HTML</button>
<button class="toggle-btn" onclick="togglePreview()">üëÅ Preview</button>

<div class="device-toggle">
  <button onclick="setDevice('mobile')">üì±</button>
  <button onclick="setDevice('tablet')">üíª</button>
  <button onclick="setDevice('desktop')">üñ•</button>
</div>

<script>
  function format(cmd) {
    document.execCommand(cmd, false, null);
  }

  document.getElementById('heading').addEventListener('change', function () {
    document.execCommand('formatBlock', false, this.value);
  });

  function drag(ev, type) {
    ev.dataTransfer.setData("type", type);
  }

  function handleDrop(e) {
    const type = e.dataTransfer.getData("type");
    let block = document.createElement('div');
    block.className = 'block';
    block.setAttribute('draggable', true);
    block.innerHTML = `<button class="remove-btn" onclick="this.parentElement.remove()">√ó</button>`;

    if (type === 'text') {
      block.innerHTML += `<div contenteditable="true">Write text here...</div>`;
    } else if (type === 'image') {
      block.innerHTML += `<input type="file" accept="image/*" onchange="previewImage(event, this)"><br><img style="max-width:100%;display:none;">`;
    } else if (type === 'section') {
      block.innerHTML += `<div contenteditable="true"><h2>Section Title</h2><p>Details go here...</p></div>`;
    } else if (type === 'button') {
      block.innerHTML += `<div contenteditable="true"><a href="#" style="padding:10px 20px;background:#007bff;color:#fff;border-radius:5px;text-decoration:none;">Click Here</a></div>`;
    } else if (type === 'divider') {
      block.innerHTML += `<hr style="border: 1px solid #ccc;" />`;
    }

    e.target.appendChild(block);
  }

  function previewImage(event, input) {
    const file = input.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function (e) {
      const img = input.nextElementSibling;
      img.src = e.target.result;
      img.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }

  function exportHTML() {
    const content = document.getElementById('editor').innerHTML;
    const blob = new Blob([`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Email</title></head><body>${content}</body></html>`], { type: "text/html" });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = "mailora-email.html";
    a.click();
  }

  function togglePreview() {
    const preview = document.getElementById('preview');
    const editor = document.getElementById('editor');
    if (preview.style.display === 'block') {
      preview.style.display = 'none';
      editor.style.display = 'block';
    } else {
      preview.textContent = editor.innerHTML;
      preview.style.display = 'block';
      editor.style.display = 'none';
    }
  }

  function setDevice(mode) {
    document.body.className = mode;
  }
</script>

</body>
</html>
